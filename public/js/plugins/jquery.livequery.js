/*! Copyright (c) 2010 Brandon Aaron (http://brandonaaron.net)
 * Dual licensed under the MIT (MIT_LICENSE.txt)
 * and GPL Version 2 (GPL_LICENSE.txt) licenses.
 *
 * Version: 1.1.1
 * Requires jQuery 1.3+
 * Docs: http://docs.jquery.com/Plugins/livequery
 */

(function(a){a.extend(a.fn,{livequery:function(c,b,d){var e=this,f;a.isFunction(c)&&(d=b,b=c,c=void 0);a.each(a.livequery.queries,function(a,h){if(e.selector==h.selector&&e.context==h.context&&c==h.type&&(!b||b.$lqguid==h.fn.$lqguid)&&(!d||d.$lqguid==h.fn2.$lqguid))return(f=h)&&!1});f=f||new a.livequery(this.selector,this.context,c,b,d);f.stopped=!1;f.run();return this},expire:function(c,b,d){var e=this;a.isFunction(c)&&(d=b,b=c,c=void 0);a.each(a.livequery.queries,function(f,g){e.selector==g.selector&& e.context==g.context&&(!c||c==g.type)&&(!b||b.$lqguid==g.fn.$lqguid)&&(!d||d.$lqguid==g.fn2.$lqguid)&&!this.stopped&&a.livequery.stop(g.id)});return this}});a.livequery=function(c,b,d,e,f){this.selector=c;this.context=b;this.type=d;this.fn=e;this.fn2=f;this.elements=[];this.stopped=!1;this.id=a.livequery.queries.push(this)-1;e.$lqguid=e.$lqguid||a.livequery.guid++;if(f)f.$lqguid=f.$lqguid||a.livequery.guid++;return this};a.livequery.prototype={stop:function(){var a=this;this.type?this.elements.unbind(this.type, this.fn):this.fn2&&this.elements.each(function(b,d){a.fn2.apply(d)});this.elements=[];this.stopped=!0},run:function(){if(!this.stopped){var c=this,b=this.elements,d=a(this.selector,this.context),e=d.not(b);this.elements=d;this.type?(e.bind(this.type,this.fn),b.length>0&&a.each(b,function(b,e){a.inArray(e,d)<0&&a.event.remove(e,c.type,c.fn)})):(e.each(function(){c.fn.apply(this)}),this.fn2&&b.length>0&&a.each(b,function(b,e){a.inArray(e,d)<0&&c.fn2.apply(e)}))}}};a.extend(a.livequery,{guid:0,queries:[], queue:[],running:!1,timeout:null,checkQueue:function(){if(a.livequery.running&&a.livequery.queue.length)for(var c=a.livequery.queue.length;c--;)a.livequery.queries[a.livequery.queue.shift()].run()},pause:function(){a.livequery.running=!1},play:function(){a.livequery.running=!0;a.livequery.run()},registerPlugin:function(){a.each(arguments,function(c,b){if(a.fn[b]){var d=a.fn[b];a.fn[b]=function(){var b=d.apply(this,arguments);a.livequery.run();return b}}})},run:function(c){c!=void 0?a.inArray(c,a.livequery.queue)< 0&&a.livequery.queue.push(c):a.each(a.livequery.queries,function(b){a.inArray(b,a.livequery.queue)<0&&a.livequery.queue.push(b)});a.livequery.timeout&&clearTimeout(a.livequery.timeout);a.livequery.timeout=setTimeout(a.livequery.checkQueue,20)},stop:function(c){c!=void 0?a.livequery.queries[c].stop():a.each(a.livequery.queries,function(b){a.livequery.queries[b].stop()})}});a.livequery.registerPlugin("append","prepend","after","before","wrap","attr","removeAttr","addClass","removeClass","toggleClass", "empty","remove","html");a(function(){a.livequery.play()})})(jQuery);
